# Financial AI Assistant - Project Update

Here is the current status of the AI Assistant integration for `replit-sim-core`.

## üöÄ Project Overview
We are building a **conversational AI interface** that sits on top of the financial simulation engine. Instead of manually configuring sliders and dropdowns, users can chat with a "Financial Coach" to set goals, add life events, and explore scenarios naturally.

## üîó Architecture & Integration
The system uses a **Bidirectional Loop** between the Python Backend (AI) and the React Frontend (Simulation).

1.  **Context Awareness (Frontend -> AI)**:
    *   The frontend captures the current simulation state (Profile, Active Scenarios, Surplus).
    *   This context is sent to the Python API (`/api/chat`) with every message.
    *   The AI uses this to give personalized advice (e.g., "You have ¬£500 monthly surplus").

2.  **Action System (AI -> Frontend)**:
    *   The Python AI ([agent_service.py](file:///c:/Users/harri/Downloads/replit-sim-core/replit-sim-core/api/agent_service.py)) analyzes user intent using a hybrid approach (Regex + LLM).
    *   It determines the desired Scenario (e.g., `buy_home`) and Parameters (e.g., `targetAmount: 50000`).
    *   It returns a structured **Action** (`OPEN_CONFIG`) to the frontend.
    *   The frontend automatically opens the correct configuration dialog with fields pre-filled.

## üìä Current Status
We are currently **mid-way through Phase 5**.

*   ‚úÖ **Phase 1-3 (Foundation)**: Backend API setup, Context passing, Financial Knowledge Base (ISA rules, etc.).
*   ‚úÖ **Phase 4a (Custom Goals)**: Smart detection of unique goals (e.g. "Space Trip").
*   ‚úÖ **Phase 4b (Universal Scenarios)**: **JUST COMPLETED**. The "Custom Scenario" engine now supports:
    *   **Income/Windfalls** ("I got a ¬£5k inheritance")
    *   **Debt/Loans** ("I need a ¬£10k car loan")
    *   **Withdrawals** ("I need to take out ¬£2k")
    *   **Savings/Expenses** (Standard goals)
*   üöß **Phase 5 (Guided Journeys)**: **NEXT UP**. Implementing a "Choose your Path" UI (Goals vs. Actions vs. Events) and refining the fallback logic.

## üõ†Ô∏è For Contributors
**Key Files to Watch:**
*   [api/agent_service.py](file:///c:/Users/harri/Downloads/replit-sim-core/replit-sim-core/api/agent_service.py): Main AI logic, prompt definitions, and parameter extraction.
*   [app-ui/src/config/configTransformers.ts](file:///c:/Users/harri/Downloads/replit-sim-core/replit-sim-core/app-ui/src/config/configTransformers.ts): Logic that converts simplified UI data into complex Simulation Modifiers. **(Heavily modified in Phase 4b)**.
*   [sim-core/src/config/scenarioRegistryData.ts](file:///c:/Users/harri/Downloads/replit-sim-core/replit-sim-core/sim-core/src/config/scenarioRegistryData.ts): Metadata definitions for all scenarios.

**Running the Stack:**
1.  **Frontend**: `npm run dev` (Port 5001)
2.  **Backend**: `python -m uvicorn api.agent_service:app --reload --port 8000`

**Environment:**
Ensure `OPENAI_API_KEY` is set in your environment variables.
